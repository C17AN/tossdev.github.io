<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
	<title>토스 결제 시작하기</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<!-- stylesheets -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/tossdev.css" />
	<link rel="stylesheet" type="text/css" href="css/prism.css" />

	<!-- javascript -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>
	<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body id="gettingstarted" data-spy="scroll" data-target="#guide" data-offset="120">
    <header id="tossdev-header">
        <div class="container">
            <div class="row">
                <a href="index.html"><img class="logo" src="images/logo_tossdev.png" alt="toss developers logo"></a>
            </div>
        </div>
    </header>
    <div class="container">
        <div class="row">
            <div class="sidebar">
                <div id="guide">
                    <h1 class="logo">
                        <a href="index.html">토스 결제 시작하기</a>
                    </h1>
                    <ul class="menu nav">
                        <li>
                            <a href="#overview">가입부터 결제 완료까지</a>
                            <ul class="nav">
                                <li><a href="#overview-0">0. 시작</a></li>
                                <li><a href="#overview-1">1. 가맹점 계정 만들기</a></li>
                                <li><a href="#overview-2">2. 토스 결제 생성 요청</a></li>
                                <li><a href="#overview-3">3. 결제 진행하기</a></li>
                                <li><a href="#overview-4">4. 결제 결과 받기</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#create">결제 생성하기</a>
                            <ul class="nav">
                                <li><a href="#create-1">API Endpoint</a></li>
                                <li><a href="#create-2">필수 Parameters</a></li>
                                <li><a href="#create-3">결제 결과 callback URL</a></li>
                                <li><a href="#create-4">주문 상태 확인 callback URL</a></li>
                                <li><a href="#create-5">결제 만료 기한</a></li>
                                <li><a href="#create-6">에스크로 여부</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#cancel">결제 취소하기</a>
                            <ul class="nav">
                                <li><a href="#cancel-1">API Endpoint</a></li>
                                <li><a href="#cancel-2">필수 Parameters</a></li>
                                <li><a href="#cancel-3">취소 사유 남기기</a></li>
                                <li><a href="#cancel-4">구매자의 결제 취소 대응</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#refund">환불하기</a>
                            <ul class="nav">
                                <li><a href="#refund-1">API Endpoint</a></li>
                                <li><a href="#refund-2">필수 Parameters</a></li>
                                <li><a href="#refund-3">환불할 금액</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#checkstatus">결제 상태 알아보기</a>
                            <ul class="nav">
                                <li><a href="#checkstatus-1">API Endpoint</a></li>
                                <li><a href="#checkstatus-2">필수 Parameters</a></li>
                                <li><a href="#checkstatus-3">결제 상태 확인 요청에 대한 응답</a></li>
                                <li><a href="#checkstatus-4">결제 상태 목록</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#iOS">iOS 앱에서 결제하기</a>
                            <ul class="nav">
                                <li><a href="#iOS-1">전체 흐름</a></li>
                                <li><a href="#iOS-2">토스 앱 설치 여부 확인</a></li>
                                <li><a href="#iOS-3">토스 앱 결제 호출</a></li>
                                <li><a href="#iOS-4">Sample Code와 상세 설명</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#android">Android 앱에서 결제하기</a>
                            <ul class="nav">
                                <li><a href="#android-1">전체 흐름</a></li>
                                <li><a href="#android-2">토스 앱 설치 여부 확인</a></li>
                                <li><a href="#android-3">토스 앱 결제 호출</a></li>
                                <li><a href="#android-4">Sample Code</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="https://toss.im/tosspay/developer/apidoc" target="_blank">API 문서 참조 <i class="fa fa-external-link" style="margin-left:4px;"></i></a>
                        </li>
                    </ul>
                </div>
            </div>

            <div id="contents">
                <div id="methods">
                    <div class="method" id="overview">
                        <div class="method-description">
                            <h3>가입부터 결제 완료까지</h3>
                            <h4 id="overview-0">0. 당신은 온라인 상점 '토스몰'을 열었습니다.</h4>
                            <p>당신은 티셔츠를 파는 온라인 상점 '토스몰'을 열었습니다.</p>
                            <p>물건을 구매하려는 손님에게 어떻게 돈을 받을지 고민하던 당신, 여러 결제 서비스를 보며 고민하다가 개발이 쉽고 손님들도 편하게 쓸 수 있는 '토스'를 써보기로 합니다.</p>
                            
                            <h4 id="overview-1">1. 토스 가맹점 계정을 만듭니다.</h4>
                            <p><a href="https://toss.im/tosspay/account/signup" target="_blank">토스 가맹점 가입 페이지</a>에서 가맹점 계정을 만들고, 당신의 소중한 상점, '토스몰'을 등록합니다. (3분 정도면 끝납니다.) 상점 등록이 완료되는 즉시 토스는 당신에게 <strong>API Key를 발급합니다.</strong> 발급받은 API Key는 '가맹점 관리자 > 상점 정보'에서 확인할 수 있습니다.</p>
                            <p class="alert alert-warning" role="alert">API Key는 '상점 열쇠'와도 같습니다. 이걸 가지고 있으면 마치 상점 주인처럼 맘대로 결제를 생성하거나 환불할 수 있습니다. 상점 주인이 문단속하듯 API Key를 잘 지켜주세요. 웹사이트 어딘가에 드러나거나 유출되지 않도록 주의해야 합니다. </p>
                            <p>당신에게 발급하는 API Key는 두 가지입니다. (테스트용 / 실거래용) 두 Key는 아래와 같은 차이가 있습니다.</p>
                            <ul>
                                <li><strong>테스트용 Key</strong> : 이 Key를 사용하면 결제의 모든 과정이 실제 결제와 동일하게 진행됩니다. 통장에서 결제 금액이 '출금'되는 것만 빼고요. 돈 빠져나갈 걱정 없이 마음껏 테스트해볼 수 있기 때문에 개발할 때 유용하게 사용할 수 있습니다.</li>
                                <li><strong>실거래용 Key</strong> : 이 Key를 사용해야 진짜 '출금'되는 결제를 할 수 있습니다. 상점에 오신 손님과 결제를 진행할 땐 꼭 이것을 사용해야 합니다.</li>
                            </ul>
                            <p>토스 결제를 한번 테스트 해보고싶지만 당장 가입하긴 귀찮다면, 아래 테스트용 Key를 사용하세요.</p>
                            <div class="well">테스트용 API Key : sk_test_4Q0kzy8WyVYaqNjzNZ9O</div>
                            <h4 id="overview-2">2. 토스몰에 첫 손님 등장 - 토스 결제 생성을 요청합니다.</h4>
                            <p>'홍길동'씨는 토스몰을 둘러보다가 35,000원짜리 '토스 티셔츠'를 선택하여 결제를 요청합니다. 이 때 토스몰은 먼저 토스에게 '결제 생성'을 요청해야합니다. 결제 생성 요청은 여기로!</p>
                            <div class="well">POST https://toss.im/tosspay/api/v1/payments</div>
                            <p>'홍길동'씨의 결제는 아래와 같이 요청합니다.</p>
                            <div class="method-example">
                                <div class="languages">
                                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                                    <a class="language" data-lang="language-java" href="#">Java</a>
                                    <a class="language" data-lang="language-php" href="#">PHP</a>
                                </div>
                                <pre><code class="language-bash">curl https://toss.im/tosspay/api/v1/payments \
    -H "content-Type: application/json" \
    -d '{
        "orderNo":"1",                                      # 토스몰 고유의 주문번호
        "amount":35000,                                     # 결제 금액
        "productDesc":"토스티셔츠",                            # 상품 정보
        "apiKey":"sk_test_4Q0kzy8WyVYaqNjzNZ9O"             # 상점의 API Key
        "resultCallback":"http://YOUR-SITE.COM/CALLBACK"    # 결제 결과를 받을 URL
        }'</code><code class="language-java">URL url = null;
URLConnection connection = null;
StringBuilder responseBody = new StringBuilder();
try {
	url = new URL("https://toss.im/tosspay/api/v1/payments");
	connection = url.openConnection();
	connection.addRequestProperty("Content-Type", "application/json");
	connection.setDoOutput(true);
	connection.setDoInput(true);
	
	org.json.simple.JSONObject jsonBody = new JSONObject();
	jsonBody.put("orderNo", "2015072012211");
	jsonBody.put("amount", 10000);
	jsonBody.put("productDesc", "토스티셔츠");
	jsonBody.put("apiKey", "sk_test_4Q0kzy8WyVYaqNjzNZ9O");
	jsonBody.put("expiredTime", "2015-07-20 16:21:00");
	jsonBody.put("orderCheckCallback", "https://myshop.com/toss/orderCheck.php");
	jsonBody.put("resultCallback", "https://myshop.com/toss/result.php");
	
	BufferedOutputStream bos = new BufferedOutputStream(connection.getOutputStream());
	bos.write(jsonBody.toJSONString().getBytes());
	bos.flush();
	bos.close();
	
	BufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream()));
	String line = null;
	while ((line = br.readLine()) != null) {
		responseBody.append(line);
	}
	br.close();
} catch (Exception e) {
	responseBody.append(e);
}
System.out.println(responseBody.toString());</code><code class="language-php">$arrayBody = array();
$arrayBody["orderNo"] = "2015072012211";
$arrayBody["amount"] = 10000;
$arrayBody["productDesc"] = "토스티셔츠";
$arrayBody["apiKey"] = "sk_test_4Q0kzy8WyVYaqNjzNZ9O";
$arrayBody["expiredTime"] = "2015-07-20 16:21:00";
$arrayBody["orderCheckCallback"] = "https://myshop.com/toss/orderCheck.php";
$arrayBody["resultCallback"] = "https://myshop.com/toss/result.php";
$jsonBody = json_encode($arrayBody);

$ch = curl_init('https://toss.im/tosspay/api/v1/payments');
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_POSTFIELDS, $jsonBody);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Content-Type: application/json',
    'Content-Length: ' . strlen($jsonBody))
);
 
$result = curl_exec($ch);
curl_close($ch);
      
echo "Response: ".$result;</code></pre>
                            </div>
                            <p>위 예제에서 알 수 있듯이 '결제 생성'을 위해서는 4가지 필수값과 callback URL을 담아 토스에 요청해야합니다.</p>
                            <ol>
                                <li><strong>상점 주문번호</strong> : 추후 상점 주문 정보와 결제 정보를 매칭하기 위해 필요</li>
                                <li><strong>결제 금액</strong> : 손님으로부터 받을 금액</li>
                                <li><strong>상품 정보</strong> : 결제할 상품에 대한 정보 (상품명)</li>
                                <li><strong>상점 API Key</strong> : 이곳에 '테스트용 Key'를 넣으면 테스트 결제가, '실거래용 Key'를 넣으면 진짜 출금되는 결제가 생성됩니다.</li>
                                <li><strong>결제 결과 callback URL</strong> : 결제 완료, 취소, 환불 등 요청에 대한 결과를 여기 적어주신 곳으로 보내드립니다.</li>
                            </ol>
                            <p class="alert alert-warning" role="alert">앞서 말씀 드렸듯, API Key는 절대 유출되어선 안됩니다. 결제 요청 내용이 웹페이지에 그대로 드러나지 않게 다시 한번 주의해주세요!</p>
                            <p>요청하신 결제 생성이 무사히 완료되면, 토스는 아래와 같이 응답합니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">{"code":0,"payToken":"7he9aYt0keNr"}</code></pre>
                            </div>
                            <p><span class="bg-info">code '0'</span>은 결제 생성에 '성공'했음을 나타냅니다. 이제 요청하신 결제가 만들어졌고, 만들어진 이 결제는 '결제 대기' 상태가 되어 홍길동님이 결제를 진행해주길 기다리게 됩니다.</p>
                            <p>함께 오는 <span class="bg-info">payToken</span> 값은 생성된 결제건의 고유번호입니다. 결제를 진행할 때, 결제를 취소하거나 환불할 때, 결제의 현재 상태를 파악할 때 이 고유번호를 통해 해당 결제 건에 접근하게 되니 잘 보관해주세요!</p>
                            <h4 id="overview-3">3. 결제 진행하기</h4>
                            <p>결제가 무사히 만들어졌지만, 기뻐하긴 이릅니다! 아직 결제 금액을 받은 것은 아니니까요. 이제 홍길동님께 결제 승인을 받아야 합니다.</p>
                            <p>결제를 승인받기 위한 각종 과정은 토스가 알아서 해드립니다. (결제에 사용할 계좌를 받고, 계좌의 유효성을 검증하고, 계좌의 주인인지 철저히 알아보는 등...) 당신이 해야할 일은 딱 하나! <span class="bg-info">홍길동님을 '결제 진행 웹페이지'로 안내하는 일</span>입니다. 아래와 같은 URL로 연결해주세요.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-http">https://toss.im/tosspay/order/orderWait?payToken=7he9aYt0keNr
&retUrl=http://YOUR-SITE.COM/ORDER-COMPLETE
                                </code></pre>
                            </div>
                            <p>결제 진행 웹페이지는<span class="bg-info">https://toss.im/tosspay/order/orderWait</span> 뒤에 두 가지 파라미터를 붙여서 연결합니다.</p>
                            <ul>
                                <li><strong>payToken</strong> : 결제 생성 완료 후 받은 결제 고유번호입니다. (잊지 않으셨죠?)</li>
                                <li><strong>retUrl</strong> : 홍길동님이 결제 완료 후 돌아가게 될 URL입니다. 예를 들어 결제 완료 후 '주문 완료 페이지'로 홍길동님을 보내고 싶다면, 여기에 해당 URL을 넣어주시면 됩니다.</li>
                            </ul>
                            <p>홍길동님이 열심히 결제를 진행하는 동안, 당신은 편한 마음으로 기다리면 됩니다만... 혹시 어떤 과정을 거치게 되는지 궁금하다면, 아래 설명을 참고해주세요.</p>
                            <div class="well">
                                1. <strong>홍길동님이 토스 결제를 처음 만났다면</strong> : 사용할 계좌를 등록하고, 결제 시 사용할 암호를 등록한 후 결제 완료 (액티브X나 앱설치가 필요 없습니다)<br>
                                2. <strong>홍길동님이 토스 결제를 써봤다면</strong> : 전화번호와 암호를 입력하면 결제 완료<br>
                                3. <strong>홍길동님이 토스 앱을 쓰고 있다면</strong> : 토스 앱으로 결제 진행 push 메시지가 발송됨. 앱에서 암호를 입력하면 결제 완료<br>
                                <br>
                                그래도 여전히 궁금하시다면 <a href="https://toss.im/tosspay/demo" target="_blank">결제 데모 페이지</a>에서 직접 경험해보세요!
                            </div>
                            <h4 id="overview-4">4. 결제 결과 받기</h4>
                            <p>홍길동님이 무사히 결제를 완료하셨습니다! 토스몰의 첫 매출이군요~</p>
                            <p>토스는 당신에게 이 기쁜 소식을 전할 것입니다. 어떻게? 결제를 생성할 때 당신이 알려준 <span class="bg-info">callback URL</span>을 활용해야죠! 지정하신 callback URL로 아래 내용들을 보내드립니다.</p>
                            <ul>
                                <li><strong>status</strong> : 결제건의 최종 상태입니다. PAY_SUCCESS, PAY_CANCEL, REFUND_SUCCESS 중 하나의 값을 가지며 각각 '결제 완료', '결제 취소', '환불 완료'를 의미합니다. (홍길동님이 결제를 완료했다면 <span class="bg-info">PAY_SUCCESS</span> 값을 받게 됩니다)</li>
                                <li><strong>payToken</strong> : 결제 고유 번호입니다.</li>
                                <li><strong>orderNo</strong> : 결제 생성 시 알려주신 '상점의 주문번호'입니다. (이 결제 결과가 토스몰의 어떤 주문에 관한 것인지 찾을 때 사용합니다)</li>
                            </ul>
                            <p>이 Callback을 받아 결제를 마무리해주세요! (결제 완료 페이지로 이동)</p>
                        </div>
                    </div>
                    <div class="method" id="create">
                        <div class="method-description">
                            <h3>결제 생성하기</h3>
                            <p>결제 생성 요청에 대해 좀 더 자세히 알아봅니다. 아래 예제는 결제 생성 API가 지원하는 모든 파라미터를 사용한 코드입니다.</p>
                            <div class="method-example">
                                <div class="languages">
                                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                                </div>
                                <pre><code class="language-bash">curl https://toss.im/tosspay/api/v1/payments \
    -H "content-Type: application/json" \
    -d '{
        "orderNo":"1",                                           # 토스몰 고유의 주문번호 (필수)
        "amount":35000,                                          # 결제 금액 (필수)
        "productDesc":"토스티셔츠",                                 # 상품 정보 (필수)
        "apiKey":"sk_test_4Q0kzy8WyVYaqNjzNZ9O",                 # 상점의 API Key (필수)
        "resultCallback":"http://YOUR-SITE.COM/CALLBACK",        # 결제 결과 callback URL
        "orderCheckCallback":"http://YOUR-SITE.COM/ORDERSTATUS", # 주문 상태 확인 Callback
        "expiredTime":"2015-12-01 12:47:35",                     # 결제 만료 예정 시각
        "escrow":false                                           # 에스크로 여부
        }'</code></pre>
                            </div>
                            <h4 id="create-1">결제 생성 API의 Endpoint</h4>
                            <div class="well">POST https://toss.im/tosspay/api/v1/payments</div>
                            <h4 id="create-2">필수 Parameters</h4>
                            <p>결제 생성 요청 시 반드시 아래 4가지 값을 함께 보내주셔야합니다.</p>
                            <ol>
                                <li><strong>상점 주문번호</strong> : 추후 상점 주문 정보와 결제 정보를 매칭하기 위해 필요</li>
                                <li><strong>결제 금액</strong> : 손님으로부터 받을 금액</li>
                                <li><strong>상품 정보</strong> : 결제할 상품에 대한 정보 (상품명)</li>
                                <li><strong>상점 API Key</strong> : 이곳에 '테스트용 Key'를 넣으면 테스트 결제가, '실거래용 Key'를 넣으면 진짜 출금되는 결제가 생성됩니다.</li>
                            </ol>
                            <h4 id="create-3">결제 결과 callback URL (resultCallback)</h4>
                            <p>결제 생성이 성공적으로 끝나면, 해당 결제건은 '결제 대기' 상태가 됩니다. 이후, 결제는 '완료'되거나 '취소'되거나 혹은 '환불'처리됩니다.</p>
                            <p>그러한 상태 변경이 있을 때 마다 상점의 주문 상태를 변경하거나 구매자에게 안내를 해주어야 한다면 '결제 결과에 대한 callback' 파라미터를 사용하세요. 이 파라미터에 응답을 받을 URL을 등록하시면, 아래와 같이 callback을 보내드리겠습니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">{
"payToken":"7he9aYt0keNr",  # 상태가 바뀐 결제건의 고유 번호
"orderNo":"1"               # 결제건과 연결된 상점 주문번호
"status":"PAY_SUCCESS",     # 최종적으로 바뀐 결과
}</code></pre>
                            </div>
                            <p>"status" 값은 결제 결과에 따라 다음과 같이 보내드립니다.</p>
                            <ul>
                                <li><strong>PAY_SUCCESS</strong> : 결제가 성공적으로 완료되었음</li>
                                <li><strong>PAY_CANCEL</strong> : 결제가 완료되기 전에 취소됨</li>
                                <li><strong>REFUND_SUCCESS</strong> : 완료된 결제가 환불 처리됨</li>
                            </ul>
                            <h4 id="create-4">주문 상태 확인 callback URL (orderCheckCallback)</h4>
                            <p>당신의 상점에서 판매하는 물품이 매우 짧은 시간 내에 재고 변동이 생기는 특성이 있다면, 이런 걱정을 하게 됩니다.</p>
                            <div class="well">"구매자가 처음 주문을 시작할 때는 재고가 있었지만, 결제를 최종 승인하는 시점에 재고가 없으면 어떡하지? 일일히 양해를 구하고 환불해줘야하잖아?</div>
                            <p>'핫딜'과 같이 짧은 시간에 대량의 주문이 발생하는 경우엔 이 문제가 더 심각해질 수 있습니다. 이런 걱정을 해결하기 위해 제공하는 것이 '주문 상태 확인 callback' 파라미터입니다.</p>
                            <p>이 파라미터에 '주문 상태를 확인해줄 수 있는' callback URL을 등록해주시면, 결제를 최종 승인하는 시점에 물품의 주문 가능 여부를 다시 한번 확인하고, 주문 가능한 경우에만 결제를 진행합니다. 입력하신 callback URL로 아래 예시와 같이 상점의 '주문 번호'를 보내드립니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">{"orderNo":"1"}</code></pre>
                            </div>
                            <p>이 요청을 받아 <strong>주문 번호에 해당하는 물품이 아직 주문 가능한 상태인지 확인해주세요.</strong> 확인 결과 주문이 가능한 상태라면, <span class="bg-info">ORDER_VALID</span>라는 문자열로 응답해주세요. (주문할 수 없는 상태라면 ORDER_VALID를 제외한 아무 값이나 응답을 주시면 됩니다)</p>
                            <h4 id="create-5">결제 만료 기한 (expiredTime)</h4>
                            <p>이 파라미터를 통해 '결제 생성 후, 언제까지 결제 승인을 진행할 수 있는지' 설정할 수 있습니다. '결제 대기' 상태인 결제건의 만료 기한이 도래하면 자동으로 결제가 취소됩니다.</p>
                            <p>상점 혹은 판매 물품에 특성에 따라 결제 만료 기간을 길게 혹은 짧게 설정할 수 있습니다.</p>
                            <ul>
                                <li>재고의 변동이 적고, 구매자의 결제가 급하지 않다면 결제 만료 기한을 길게 설정하세요. 구매자는 먼저 주문만 해두고 원하는 시점에 결제할 수 있습니다. (예를 들어, 주문은 오전에 하고 밤에 Toss 앱을 설치하여 결제를 완료할 수 있습니다)</li>
                                <li>재고의 변동이 크거나 '결제 대기' 상태를 오래 지속하고싶지 않은 경우엔 결제 만료 기한을 짧게 설정하세요.</li>
                            </ul>
                            <p>결제 만료 기한은 <span class="bg-info">최소 10분, 최대 24시간</span>이며, 따로 설정하지 않는 경우 24시간으로 설정됩니다.</p>
                            <h4 id="create-6">에스크로 여부 (escrow)</h4>
                            <p>에스크로 결제로 진행할지 설정할 수 있습니다.</p>
                            <ul>
                                <li><strong>true</strong> : 에스크로 결제를 생성합니다.</li>
                                <li><strong>false</strong> : 일반 결제를 생성합니다. (값을 설정하지 않으면 false)</li>
                            </ul>
                            <p>에스크로 결제는 일종의 '구매자 보호 정책'입니다. 온라인 상에서 실물거래를 하는 경우, 구매자가 판매자에게 입금은 하였으나 물품을 받지 못하거나 원치 않는 물품을 받았을 경우 금전적 손실이 발생할 수 있는데, 이를 방지하기 위한 것입니다.</p>
                            <p>결제가 완료되면 결제 금액만큼 구매자의 계좌에서 출금되지만, 구매자가 물품을 정상적으로 받았다고 확정(구매확정)하기 전까지는 정산되지 않습니다. 따라서 구매자는 좀 더 안심하고 물품을 구매할 수 있습니다.</p>
                            <p class="alert alert-warning" role="alert">온라인상에서 실물을 판매하는 경우, 구매자에게 '에스크로 결제'를 선택할 수 있는 권한을 필수적으로 제공해야합니다.</p>
                        </div>
                    </div>
                    <div class="method" id="cancel">
                        <div class="method-description">
                            <h3>결제 취소하기</h3>
                            <p>결제가 아직 완료되지 않은 '대기' 상태에서 결제를 취소할 수 있습니다. 아래 예제는 결제 취소 API가 지원하는 모든 파라미터를 사용한 코드입니다.</p>
                            <div class="method-example">
                                <div class="languages">
                                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                                </div>
                                <pre><code class="language-bash">curl "https://toss.im/tosspay/api/v1/cancel" \
    -H "content-Type: application/json" \
    -d '{
        "apiKey":"sk_test_4Q0kzy8WyVYaqNjzNZ9O",    # 상점의 API Key (필수)
        "payToken":"7he9aYt0keNr",                  # 결제 고유 번호 (필수)
        "reason":"재고 부족"                          # 취소 사유
        }'
</code></pre>
                            </div>
                            <h4 id="cancel-1">결제 취소 API의 Endpoint</h4>
                            <div class="well">POST https://toss.im/tosspay/api/v1/cancel</div>
                            <h4 id="cancel-2">필수 Parameters</h4>
                            <p>필수 파라미터는 딱 2가지 입니다. '어느 가맹점'에서 '어떤 결제건'을 취소하는지만 알려주세요!</p>
                            <ol>
                                <li><strong>상점 API Key</strong> : 결제를 생성한 상점의 API key가 필요합니다.</li>
                                <li><strong>결제 고유 토큰 (payToken)</strong> : 결제 생성 완료 후 받은 결제 고유번호</li>
                            </ol>
                            <h4 id="cancel-3">취소 사유 남기기 (reason)</h4>
                            <p>결제 취소 사유를 기록해야한다면 이 파라미터를 활용하세요. <span class="bg-info">최대 50자까지</span> 남길 수 있습니다. (string)</p>
                            <h4 id="cancel-4">구매자의 결제 취소 대응</h4>
                            <p>구매자도 결제를 취소할 수 있습니다. 이에 대응하기 위해 결제 생성 시 callback URL을 등록하고, '취소'가 발생한 경우 적절한 처리를 해주세요. (주문 상태 변경 등)</p>
                        </div>
                    </div>
                    <div class="method" id="refund">
                        <div class="method-description">
                            <h3>환불하기</h3>
                            <p>결제 완료 건의 결제 금액 중 일부 또는 전부를 구매자에게 돌려줍니다. (환불 요청에 성공하는 즉시 구매자의 계좌로 요청하신 금액이 입금되며, 환불한 금액은 상점의 다음 정산에 반영됩니다)</p>
                            <p>아래 예제는 결제 환불 API가 지원하는 모든 파라미터를 사용한 코드입니다.</p>
                            <div class="method-example">
                                <div class="languages">
                                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                                </div>
                                <pre><code class="language-bash">curl "https://toss.im/tosspay/api/v1/refunds" \
    -H "content-Type: application/json" \
    -d '{
        "apiKey":"sk_test_4Q0kzy8WyVYaqNjzNZ9O",    # 상점의 API Key (필수)
        "payToken":"7he9aYt0keNr",                  # 결제 고유 번호 (필수)
        "amount":10000                              # 환불할 금액
        }'
</code></pre>
                            </div>
                            <h4 id="refund-1">결제 환불 API의 Endpoint</h4>
                            <div class="well">POST https://toss.im/tosspay/api/v1/refunds</div>
                            <h4 id="refund-2">필수 Parameters</h4>
                            <p>'결제 취소'와 마찬가지로 필수 파라미터는 딱 2가지 입니다. '어느 가맹점'에서 '어떤 결제건'을 환불하는지만 알려주세요!</p>
                            <ol>
                                <li><strong>상점 API Key</strong> : 결제를 생성한 상점의 API key가 필요합니다.</li>
                                <li><strong>결제 고유 토큰 (payToken)</strong> : 결제 생성 완료 후 받은 결제 고유번호</li>
                            </ol>
                            <h4 id="refund-3">환불할 금액</h4>
                            <p>환불할 금액을 설정하지 않으면 결제 금액 전액을 환불합니다. 결제 금액 중 일부만 환불하려는 경우, 이 파라미터 값을 설정해주세요.</p>
                        </div>
                    </div>
                    <div class="method" id="checkstatus">
                        <div class="method-description">
                            <h3>결제 상태 알아보기</h3>
                            <p>결제가 생성되고 진행됨에 따라 결제의 '상태'는 끊임없이 바뀝니다. 상점 운영을 위해선 특정 결제건이 현재 어떤 상태인지 파악할 일이 많을 것입니다. 결제가 잘 끝난 것인지, 취소된 것은 아닌지. 환불 요청에 들어왔던 주문은 잘 환불 되었는지...</p>
                            <p>그럴땐 망설이지 말고 '결제 상태 확인 API'를 찾아주세요. 아래 예제는 결제 상태 확인 API 호출 코드입니다.</p>
                            <div class="method-example">
                                <div class="languages">
                                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                                </div>
                                <pre><code class="language-bash">curl "https://toss.im/tosspay/api/v1/status" \
    -H "content-Type: application/json" \
    -d '{
        "apiKey":"sk_test_4Q0kzy8WyVYaqNjzNZ9O",    # 상점의 API Key (필수)
        "payToken":"7he9aYt0keNr",                  # 결제 고유 번호 (필수)
        }'
</code></pre>
                            </div>
                            <h4 id="checkstatus-1">결제 상태 확인 API의 Endpoint</h4>
                            <div class="well">POST https://toss.im/tosspay/api/v1/status</div>
                            <h4 id="checkstatus-2">필수 Parameters</h4>
                            <p>필수 파라미터는 딱 2가지 입니다. '어느 가맹점'에서 일어난 '어떤 결제건'을 조회하고 싶은지 알려주세요.</p>
                            <ol>
                                <li><strong>상점 API Key</strong> : 결제를 생성한 상점의 API key가 필요합니다.</li>
                                <li><strong>결제 고유 토큰 (payToken)</strong> : 결제 생성 완료 후 받은 결제 고유번호</li>
                            </ol>
                            <p>* '결제 고유 토큰 (payToken)' 대신 '상점의 주문번호 (orderNo)'값을 사용할 수도 있습니다.</p>
                            <h4 id="checkstatus-3">결제 상태 확인 요청에 대한 응답</h4>
                            <p>결제 상태 확인 요청에 대한 응답은 아래와 같은 형태로 받게됩니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">{
    "code":0,                           # 응답코드
    "payToken":"7he9aYt0keNr"           # 결제 고유 번호
    "orderNo":"2015072012211",          # 상점의 주문번호
    "payStatus":"REFUND_SUCCESS",       # 결제 상태
    "availableActions ":["REFUND"],     # 가능한 액션 목록
    "hasOwner":true,                    # 결제할 사람의 정보 입력 여부
}
</code></pre>
                            </div>
                            <p>각 항목은 다음과 같은 의미를 가지고 있습니다.</p>
                            <ul>
                                <li><strong>응답코드</strong> : 요청에 대한 결과. 성공하면 '0' 입니다.</li>
                                <li><strong>결제 고유 번호</strong> : 결제 생성 완료 후 받은 결제 고유번호. '주문번호'로 상태를 조회하면 이 값을 참조하여 '결제 고유번호 값을 알 수 있습니다.</li>
                                <li><strong>상점의 주문번호</strong> : 상점에서 사용하는 주문번호. 'payToken'으로 상태를 조회하면 이 값을 참조하여 '주문번호'를 알 수 있습니다.</li>
                                <li><strong>결제 상태</strong> : 조회 당시의 결제 상태 (아래 '결제 상태 목록'을 참고하세요)</li>
                                <li><strong>가능한 액션 목록</strong> : 조회 당시에 가능한 액션(취소, 환불 등) 목록 (예를 들어, '결제 완료' 상태에서는 '환불'이 가능하나 '전액 환불'한 상태에서는 환불 불가)</li>
                                <li><strong>결제할 사람의 정보 입력 여부</strong> : 당신의 상점에서 결제를 생성하고 결제 진행 웹페이지를 구매자에게 제공하고 나면 구매자는 결제 승인에 필요한 정보를 입력합니다. 결제를 진행할 사람에 대한 정보가 올바르게 입력되면 이 값은 <span class="bg-info">true</span>가 됩니다. 반면, 아직 정보를 입력하지 않은 상태라면 <span class="bg-info">false</span> 입니다.</li>
                            </ul>
                            <h4 id="checkstatus-4">결제 상태 목록</h4>
                            <p>결제 상태는 아래 중 하나입니다.</p>
                            <table class="table table-hover">
                                <tr>
                                  <td>PAY_STANDBY</td>
                                  <td>결제 대기 중</td>
                                </tr>
                                <tr>
                                  <td>PAY_CANCEL</td>
                                  <td>결제 취소</td>
                                </tr>
                                <tr>
                                  <td>PAY_PROGRESS</td>
                                  <td>결제 진행 중</td>
                                </tr>
                                <tr>
                                  <td>PAY_COMPLETE</td>
                                  <td>결제 완료</td>
                                </tr>
                                <tr>
                                  <td>ESCROW_REQUEST</td>
                                  <td>에스크로 요청</td>
                                </tr>
                                <tr>
                                  <td>ESCROW_RELEASE</td>
                                  <td>에스크로 해제</td>
                                </tr>
                                <tr>
                                  <td>ESCROW_DENY</td>
                                  <td>에스크로 거부</td>
                                </tr>
                                <tr>
                                  <td>REFUND_PROGRESS</td>
                                  <td>환불 진행 중</td>
                                </tr>
                                <tr>
                                  <td>REFUND_SUCCESS</td>
                                  <td>환불 성공</td>
                                </tr>
                                <tr>
                                  <td>SETTLEMENT_COMPLETE</td>
                                  <td>정산 완료</td>
                                </tr>
                                <tr>
                                  <td>SETTLEMENT_REFUND_COMPLETE</td>
                                  <td>환불 정산 완료</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="method" id="iOS">
                        <div class="method-description">
                            <h3>iOS 앱에서 결제하기</h3>                            
                            <p>iOS 앱을 만드셨나요? iOS 앱 내에서 토스 결제를 이용할 경우, 약간의 대응을 해주시면 훨씬 매끄러운 결제 경험을 제공할 수 있습니다.</p>
                            <h4 id="iOS-1">전체 흐름</h4>
                            <ol>
                                <li>'<a href="#create">결제 생성</a>'을 완료</li>
                                <li>토스 앱이 설치되어있는지 확인</li>
                                <li>설치되어있으면 토스 앱을 호출하여 결제를 진행하고 설치되어있지 않다면 <a href="#overview-3">결제 진행 웹페이지를 호출</a>하여 결제를 진행</li>
                                <li>토스 앱을 통해 결제가 완료되면 다시 상점 앱으로 돌아감</li>
                            </ol>
                            <h4 id="iOS-2">토스 앱 설치 여부 확인</h4>
                            <p>아래 scheme을 통해 확인할 수 있습니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">supertoss://</code></pre>
                            </div>
                            <h4 id="iOS-3">토스 앱 결제 호출</h4>
                            <p>아래 예제 코드와 같이 custom scheme을 이용하여 결제를 호출할 수 있습니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">supertoss://pay?payToken=[7he9aYt0keNr]
</code></pre>
                            </div>
                            <p>여기서 payToken값은 '결제 생성' 완료 후 받은 결제 고유번호입니다.</p>
                            <p>위 코드에 몇가지 값을 추가하면 토스 앱에서 결제를 완료한 후, 좀 더 매끄럽게 상점 앱으로 돌아갈 수 있습니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">supertoss://x-callback-url/pay?payToken=[7he9aYt0keNr]
                                &x-source=[토스몰]
                                &x-success=[tossmallapp://orderComplete]
</code></pre>
                            </div>
                            <p>위 예제 코드에서 각 값은 아래와 같은 의미를 가지고 있습니다.</p>
                            <ul>
                                <li><strong>payToken</strong> : '결제 생성' 완료 후 받은 결제 고유번호</li>
                                <li><strong>x-source</strong> : Toss 앱에서 결제 완료 후 제공되는 '돌아가기' 버튼에 표시될 텍스트입니다. 당신의 상점/앱 이름을 넣어주세요.</li>
                                <li><strong>x-success</strong> : '돌아가기' 버튼을 눌렀을 때 실행될 Scheme입니다. 당신의 상점앱에서 결제를 완료한 고객이 가야할 곳을 지정해주세요. (당신의 상점앱 Custom Scheme등을 활용하세요)</li>
                            </ul>
                            <h4 id="iOS-4">Sample Code와 더 상세한 설명</h4>
                            <p>토스 결제를 테스트하기 위한 iOS 샘플 코드와 상세한 설명을 확인하세요.<br>
                                <a href="https://github.com/tossdev/tossdev.github.io/tree/master/appSampleCode/TossPayExample_iOS" target="_blank">https://github.com/tossdev/tossdev.github.io/tree/master/appSampleCode/TossPayExample_iOS</a></p>
                        </div>
                    </div>
                    <div class="method" id="android">
                        <div class="method-description">
                            <h3>Android 앱에서 결제하기</h3>
                            <p>Android 앱을 만드셨나요? Android 앱 내에서 토스 결제를 이용할 경우, 약간의 대응을 해주시면 훨씬 매끄러운 결제 경험을 제공할 수 있습니다.</p>
                            <h4 id="android-1">전체 흐름</h4>
                            <ol>
                                <li>'<a href="#create">결제 생성</a>'을 완료</li>
                                <li>토스 앱이 설치되어있는지 확인</li>
                                <li>설치되어있으면 토스 앱을 호출하여 결제를 진행하고 설치되어있지 않다면 <a href="#overview-3">결제 진행 웹페이지를 호출</a>하여 결제를 진행</li>
                                <li>토스 앱을 통해 결제가 완료되면 다시 상점 앱으로 돌아감</li>
                            </ol>
                            <h4 id="android-2">토스 앱 설치 여부 확인</h4>
                            <p>아래의 패키지를 통해 확인 가능합니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">viva.republica.toss</code></pre>
                            </div>
                            <h4 id="android-3">토스 앱 결제 호출</h4>
                            <p>아래 예제 코드와 같이 custom scheme을 이용하여 결제를 호출할 수 있습니다.</p>
                            <div class="method-example">
                                <pre><code class="always-visible language-bash">supertoss://pay?payToken=[7he9aYt0keNr]
</code></pre>
                            </div>
                            <p>여기서 payToken값은 '결제 생성' 완료 후 받은 결제 고유번호입니다.</p>
                            <h4 id="android-4">Sample Code</h4>
                            <p>아래 샘플 코드를 통해 직접 테스트해보실 수 있습니다.<br>
                            <a href="https://github.com/tossdev/tossdev.github.io/tree/master/appSampleCode/TossPayExample_android" target="_blank">https://github.com/tossdev/tossdev.github.io/tree/master/appSampleCode/TossPayExample_android</a></p>
                        </div>
                    </div>
                </div>                    
            </div>
        </div>
    </div>

	<script type="text/javascript">
		$(function () {
//			hljs.configure({
//			  tabReplace: '  ',
//			  classPrefix: ''
//			})
//			hljs.initHighlightingOnLoad();

			// language toggle
			var $languages = $(".languages .language");
			$languages.click(function (e) {
				e.preventDefault();
				var lang = $(this).data("lang");
				$languages.removeClass("selected");
				$(this).addClass("selected");

				$("pre code").hide();
				$("pre code." + lang).css("display", "block");
			});
		});
	</script>
    <script src="js/prism.js"></script>
</body>
</html>